<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Painel Administrativo</title>

    <link rel="stylesheet" th:href="@{dist/css/admin-dashboard.css}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body>
    <header class="navbar navbar-dark bg-primary p-3">
        <a class="navbar-brand ms-3" href="/admin/dashboard">Painel Administrativo</a>
        <a href="/logout" class="btn btn-outline-light me-3">Sair</a>
    </header>

    <div class="container mt-4">
        <h2 class="mb-4 text-center">Resumo de Vendas</h2>

        <div class="row mb-4 text-center">
            <div class="card p-4">
                <h4 class="mb-3">Gráfico de Vendas por Mês</h4>
                <canvas id="graficoVendas" height="120"></canvas>
            </div>
        </div>

    </div>

    <!-- Seção da Tabela de Produtos -->
    <div class="container mt-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title mb-3">Produtos Cadastrados</h5>
                <a th:href="@{/admin/produtos/novo}" class="btn btn-secondary btn-sm">
                    <i class="fa-solid fa-file-circle-plus"></i>
                </a>
                <div class="table-responsive">
                    <table class="table table-striped align-middle">
                        <thead class="table-light">
                            <tr>
                                <th>Imagem</th>
                                <th>Nome</th>
                                <th>Categoria</th>
                                <th>Preço</th>
                                <th>Destaque</th>
                                <th>Promoção</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="produto : ${produtos}">
                                <td>
                                    <img th:src="|/imagem/${produto.idProduto}|" width="70" class="rounded">
                                </td>
                                <td th:text="${produto.nome}"></td>
                                <td th:text="${produto.categoria.nome}"></td>
                                <td th:text="${#numbers.formatDecimal(produto.preco, 2, 'COMMA', 2, 'POINT')}"></td>
                                <td>
                                    <span th:text="${produto.destaque} ? 'Sim' : 'Não'"
                                        th:classappend="${produto.destaque} ? 'text-success' : 'text-muted'"></span>
                                </td>
                                <td>
                                    <span th:text="${produto.emPromocao} ? 'Sim' : 'Não'"
                                        th:classappend="${produto.emPromocao} ? 'text-warning' : 'text-muted'"></span>
                                </td>
                                <td>
                                    <a th:href="@{/admin/produtos/editar/{id}(id=${produto.idProduto})}"
                                        class="btn btn-primary btn-sm">
                                        <i class="fa fa-edit"></i> Editar
                                    </a>
                                    <a th:href="@{/admin/produtos/remover/{id}(id=${produto.idProduto})}"
                                        class="btn btn-danger btn-sm"
                                        onclick="return confirm('Deseja excluir este produto?');">
                                        <i class="fa fa-trash"></i> Excluir
                                    </a>
                                </td>
                            </tr>
                            <tr th:if="${#lists.isEmpty(produtos)}">
                                <td colspan="6" class="text-center text-muted py-3">Nenhum produto cadastrado.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script th:src="@{/dist/js/admin-dashboard.js}"></script>
</body>

</html>